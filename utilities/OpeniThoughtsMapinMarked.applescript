property pTitle : "Open active iThoughtsX map in Marked 2"property pVer : "0.2"property pblnPositionWindows : true -- Set this to false to disable the window positioning at the end of the scriptproperty pH : missing valueproperty pY : missing valuetell application "System Events"	set lstProc to application processes where name contains "ithoughtsx"	if lstProc is not equal to {} then		set winThoughts to front window of (item 1 of lstProc)		set strURL to value of (attribute "AXDocument" of winThoughts)				do shell script "open -a Marked\\ 2 " & quoted form of strURL		if pblnPositionWindows then			--set lngWidth to word 3 of (do shell script "defaults read /Library/Preferences/com.apple.windowserver | grep -w Width")			--set lngHeight to word 3 of (do shell script "defaults read /Library/Preferences/com.apple.windowserver | grep -w Height")						set {lngWidth, lngHeight} to my displayResoln()						set lngHeight to lngHeight - 22						--set lngHalf to lngWidth / 2			set lngThird to lngWidth / 3						-- 50/50			--tell oWin to tell window 1 to set {position, size} to {{lngHalf, 22}, {lngHalf, lngHeight}}			--tell process "Marked 2" to tell window 1 to set {position, size} to {{0, 22}, {lngHalf, lngHeight}}						-- or 1/3 2/3			tell winThoughts to set {position, size} to {{lngThird, 22}, {lngThird * 2, lngHeight}}						set lstProc to application processes where name contains "marked 2"			if lstProc is not equal to {} then				set winMarked to front window of (item 1 of lstProc)				tell winMarked to set {position, size} to {{0, 22}, {lngThird, lngHeight}}			end if		end if	end ifend tellon displayResoln()	if (pH is missing value) or (pY is missing value) then		set {dlm, my text item delimiters} to {my text item delimiters, "Resolution"}		set lstDisplays to text items of (do shell script "system_profiler SPDisplaysDataType")				repeat with i from 2 to length of lstDisplays			set strLine to item i of lstDisplays			if strLine contains "Main Display: Yes" then exit repeat		end repeat		set my text item delimiters to space		set lstParts to text items of strLine		set my text item delimiters to dlm		set pH to item 2 of lstParts		set pY to item 4 of lstParts			end if	return {pH, pY}end displayResoln